<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biên lai học phí - TRƯỜỜNG CAO ĐẲNG XÂY DỰNG TP. HỒ CHÍ MINH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Styles for editable fields */
        [contenteditable="true"] {
            outline: 1px dashed #d1d5db; /* gray-300 */
            cursor: text;
            padding: 0 4px;
            border-radius: 4px;
        }
        [contenteditable="true"]:hover,
        [contenteditable="true"]:focus {
            outline: 2px solid #fb923c; /* orange-400 */
            background-color: #fff7ed; /* orange-50 */
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .no-print {
                display: none;
            }
            /* Hide editable styles when printing */
            [contenteditable="true"] {
                outline: none;
                padding: 0 4px;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">
    <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-lg">
        <!-- Action Buttons -->
        <div class="no-print p-4 text-right space-x-4 bg-gray-50 rounded-t-lg border-b">
             <button onclick="randomizeData()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow-sm transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 01-9.223 3.832L3.467 17.88a1 1 0 01-1.334-1.49l2.44-2.179a5.5 5.5 0 018.739-2.787zM8.5 3a5.5 5.5 0 017.96 4.056l-2.44 2.179a1 1 0 01-1.335 1.49l2.622-2.622a5.5 5.5 0 01-6.807-5.103zM15 8.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM5 11.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" clip-rule="evenodd" />
                </svg>
                Tạo ngẫu nhiên
            </button>
            <button onclick="window.print()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-lg shadow-sm transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-orange-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd" />
                </svg>
                In biên lai
            </button>
        </div>

        <div class="print-area p-6 sm:p-10">
            <!-- Header Section -->
            <header class="flex flex-col sm:flex-row justify-between items-start pb-6 border-b-2 border-orange-600">
                <div class="flex items-center space-x-4">
                    <img src="https://scontent.fhan2-5.fna.fbcdn.net/v/t39.30808-6/309259698_213800544316602_1409278654902742379_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeE4T6C5720JRl6CS7PJvanJ-AJj2mTogZX4AmPaZOiBlYPRX8d2MIuyu4t1J86BtWMjOqYk3cyU599-Bf-8CkEl&_nc_ohc=Xyj_wybS2ZMQ7kNvwHKIPCr&_nc_oc=AdnQDHqIHQbvIrsAUJjxxwfnKTPDR-kUX8WARp3fUGOUvGAss4O_JSthEWhHl66JJSg&_nc_zt=23&_nc_ht=scontent.fhan2-5.fna&_nc_gid=65dyTNN3dGojuBd0hLZO9w&oh=00_AfcQvEfsldUryKBCyal4iya2B-i0cnQXEHR0Xw6xiFRFnA&oe=68EC58D0" alt="Logo Trường CĐ Xây dựng TP.HCM" class="w-24 h-24">
                    <div>
                        <h1 class="text-xl sm:text-2xl font-bold text-gray-800">TRƯỜNG CAO ĐẲNG XÂY DỰNG TP. HỒ CHÍ MINH</h1>
                        <p class="text-sm text-gray-500">190 Võ Văn Ngân, P. Linh Chiểu, TP. Thủ Đức, TP. HCM</p>
                        <p class="text-sm text-gray-500">tuyensinh@hcmcc.edu.vn | (028) 3896 0087</p>
                    </div>
                </div>
                <div class="text-left sm:text-right mt-4 sm:mt-0">
                    <h2 class="text-2xl font-semibold text-gray-700">BIÊN LAI HỌC PHÍ</h2>
                    <p class="text-gray-500"><strong>Số biên lai:</strong> <span id="receiptNo" contenteditable="true">HCC2025-09-54321</span></p>
                    <p class="text-gray-500"><strong>Ngày cấp:</strong> <span id="dateIssued" contenteditable="true">08/09/2025</span></p>
                </div>
            </header>

            <!-- Student and Payment Info Section -->
            <section class="grid grid-cols-1 md:grid-cols-2 gap-8 my-8">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">Thanh toán cho:</h3>
                    <p id="fullName" class="font-bold text-gray-700" contenteditable="true">Nguyễn Văn An</p>
                    <p class="text-gray-600"><strong>Mã số sinh viên:</strong> <span id="studentId" contenteditable="true">SV87654321</span></p>
                    <p class="text-gray-600"><strong>Ngày sinh:</strong> <span id="dob" contenteditable="true">15/01/2005</span></p>
                    <p class="text-gray-600"><strong>Chương trình học:</strong> <span id="program" contenteditable="true">CN. Công nghệ thông tin</span></p>
                    <p class="text-gray-600"><strong>Email sinh viên:</strong> <span id="studentEmail" contenteditable="true">an.nguyen.123@hcmcc.edu.vn</span></p>
                    <p class="text-gray-600"><strong>Học kỳ:</strong> <span contenteditable="true">Học kỳ I (2025-2026)</span></p>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
                    <h3 class="text-lg font-semibold text-gray-800">Tình trạng thanh toán</h3>
                    <p class="text-2xl font-bold text-green-600 mt-2">ĐÃ THANH TOÁN ĐẦY ĐỦ</p>
                    <p class="text-sm text-gray-600 mt-1"><strong>Ngày thanh toán:</strong> <span id="paymentDate" contenteditable="true">01/09/2025</span></p>
                    <p class="text-sm text-gray-600"><strong>Mã giao dịch:</strong> <span id="transactionId" contenteditable="true">987654321ABC</span></p>
                </div>
            </section>

            <!-- Fee Details Table -->
            <section class="mt-10">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Bảng kê chi tiết</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50 border-b">
                            <tr>
                                <th class="p-4 font-semibold text-gray-600">Mô tả</th>
                                <th class="p-4 font-semibold text-gray-600 text-right">Số tiền (VNĐ)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="p-4 text-gray-700" contenteditable="true">Học phí chính quy</td>
                                <td class="p-4 text-gray-800 text-right fee-item" contenteditable="true" oninput="calculateTotals()">15,000,000 VNĐ</td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-4 text-gray-700" contenteditable="true">Phí dịch vụ sinh viên</td>
                                <td class="p-4 text-gray-800 text-right fee-item" contenteditable="true" oninput="calculateTotals()">500,000 VNĐ</td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-4 text-gray-700" contenteditable="true">Phí y tế</td>
                                <td class="p-4 text-gray-800 text-right fee-item" contenteditable="true" oninput="calculateTotals()">300,000 VNĐ</td>
                            </tr>
                            <tr class="border-b">
                                <td class="p-4 text-gray-700" contenteditable="true">Phí công nghệ và học liệu</td>
                                <td class="p-4 text-gray-800 text-right fee-item" contenteditable="true" oninput="calculateTotals()">250,000 VNĐ</td>
                            </tr>
                             <tr class="border-b">
                                <td class="p-4 text-gray-700" contenteditable="true">Phí hội sinh viên</td>
                                <td class="p-4 text-gray-800 text-right fee-item" contenteditable="true" oninput="calculateTotals()">100,000 VNĐ</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td class="p-4 font-semibold text-gray-800 text-right">Tổng phụ</td>
                                <td id="subtotal" class="p-4 font-semibold text-gray-800 text-right">16,150,000 VNĐ</td>
                            </tr>
                            <tr class="text-blue-600">
                                <td class="p-4 font-semibold text-right" contenteditable="true">Học bổng khuyến khích</td>
                                <td id="scholarship" class="p-4 font-semibold text-right" contenteditable="true" oninput="calculateTotals()">(5,000,000 VNĐ)</td>
                            </tr>
                            <tr class="bg-gray-100">
                                <td class="p-4 font-bold text-lg text-gray-900 text-right">Tổng cộng phải trả</td>
                                <td id="totalDue" class="p-4 font-bold text-lg text-gray-900 text-right">11,150,000 VNĐ</td>
                            </tr>
                            <tr>
                                <td class="p-4 font-semibold text-gray-800 text-right">Số tiền đã trả</td>
                                <td id="amountPaid" class="p-4 font-semibold text-gray-800 text-right" contenteditable="true" oninput="calculateTotals()">11,150,000 VNĐ</td>
                            </tr>
                            <tr class="bg-green-100">
                                <td class="p-4 font-bold text-xl text-green-700 text-right">Số dư</td>
                                <td id="balanceDue" class="p-4 font-bold text-xl text-green-700 text-right">0 VNĐ</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </section>

            <!-- Footer -->
            <footer class="mt-10 pt-6 border-t text-center text-gray-500 text-sm">
                <p>Cảm ơn bạn đã thanh toán. Đây là biên lai chính thức từ Phòng Tài chính.</p>
                <p>Nếu có bất kỳ câu hỏi nào, vui lòng liên hệ với văn phòng chúng tôi kèm theo Mã số sinh viên.</p>
                <p class="mt-2 font-semibold">TRƯỜNG CAO ĐẲNG XÂY DỰNG TP. HỒ CHÍ MINH</p>
            </footer>
        </div>
    </div>

    <script>
        // --- Helper functions for currency parsing and formatting ---
        function parseCurrency(text) {
            if (typeof text !== 'string') return 0;
            const isNegative = text.includes('(') && text.includes(')');
            let numString = text.replace(/[^0-9-]/g, '');
            let value = parseFloat(numString);
            if (isNaN(value)) return 0;
            return isNegative ? -Math.abs(value) : value;
        }

        function formatCurrency(value, useParenthesesForNegative = false) {
            if (isNaN(value)) return '0 VNĐ';
            const absValue = Math.abs(value);
            // Round to nearest 1000
            const roundedValue = Math.round(absValue / 1000) * 1000;
            const formattedNumber = roundedValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            if (value < 0) {
                return useParenthesesForNegative ? `(${formattedNumber} VNĐ)` : `-${formattedNumber} VNĐ`;
            }
            return `${formattedNumber} VNĐ`;
        }
        
        function removeDiacritics(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/đ/g, "d").replace(/Đ/g, "D");
        }

        // --- Main functionalities ---
        function calculateTotals() {
            try {
                let subtotal = 0;
                document.querySelectorAll('.fee-item').forEach(item => {
                    subtotal += parseCurrency(item.innerText);
                });
                document.getElementById('subtotal').innerText = formatCurrency(subtotal);

                const scholarshipEl = document.getElementById('scholarship');
                const scholarshipVal = -Math.abs(parseCurrency(scholarshipEl.innerText));

                const totalDue = subtotal + scholarshipVal;
                document.getElementById('totalDue').innerText = formatCurrency(totalDue);

                const amountPaid = parseCurrency(document.getElementById('amountPaid').innerText);

                const balanceDue = totalDue - amountPaid;
                document.getElementById('balanceDue').innerText = formatCurrency(balanceDue);
            } catch (e) {
                console.error("Error calculating totals:", e);
            }
        }
        
        function randomizeData() {
            // --- Student Info Data ---
            const vietnameseLastNames = ["Nguyễn", "Trần", "Lê", "Phạm", "Hoàng", "Huỳnh", "Võ", "Vũ", "Phan", "Trương", "Bùi", "Đặng", "Đỗ", "Ngô", "Hồ", "Dương", "Đinh", "Lý", "Vương", "Trịnh", "Đào", "Đoàn", "Tôn", "Mai", "Lương", "Thạch", "Tạ", "Lưu", "Tăng", "Châu", "Lâm", "Chung", "Thân", "Tiêu", "La", "Diệp", "Mạc", "Cung", "Hà", "Hứa", "Kim", "Cổ", "Phùng", "Quách", "Tô", "Từ", "Giáp", "Tưởng", "Uông", "Vi", "Vòng", "Dư", "Lại", "Lữ", "Tòng", "Chế", "Đồng", "Đàm", "Kỷ", "Khổng", "Khúc", "Kiều", "Mẫn", "Nhan", "Nhâm", "Ninh", "Ông"];
            const vietnameseMiddleAndFirstNames = ["Văn An", "Thị Bích", "Hùng Dũng", "Minh Tuấn", "Thu Trang", "Quốc Bảo", "Mỹ Linh", "Gia Huy", "Khánh Ly", "Đức Anh", "Phương Anh", "Bảo Châu", "Công Vinh", "Hồng Nhung", "Thanh Tùng", "Ngọc Diệp", "Thế Hiển", "Tú Anh", "Xuân Trường", "Yến Nhi", "Bảo Long", "Minh Khang", "Thiên Ân", "Phúc Hưng", "Gia Khiêm", "Tuấn Kiệt", "Tùng Lâm", "Ðức Huy", "Anh Khoa", "Hoàng Bách", "Hải Đăng", "Mạnh Hùng", "Quang Minh", "Nhật Duy", "Ðức Phúc", "Thành Công", "An Nhiên", "Bảo Ngọc", "Cát Tường", "Diệu Anh", "Hà My", "Hoài An", "Hương Ly", "Khánh An", "Linh Chi", "Mai Anh", "Minh Châu", "Ngọc Anh", "Phương Linh", "Quỳnh Anh", "Thanh Hà", "Thảo Nguyên", "Thùy Dương", "Thủy Tiên", "Tuệ Mẫn", "Tuyết Nhung", "Uyên Thư", "Vân Khánh", "Ánh Dương", "Ðan Tâm", "Ðông Nghi", "Hạ Băng", "Kiều Dung", "Lan Hương", "Lệ Quyên", "Mộc Miên", "Mỹ Duyên", "Nguyệt Ánh", "Nhã Phương", "Phi Yến"];
            const programs = ["CN. Công nghệ thông tin", "QT. Quản trị kinh doanh", "KT. Kỹ thuật xây dựng", "KT. Kiến trúc", "NN. Ngôn ngữ Anh"];
            const months = ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"];

            const getRandomItem = (arr) => arr[Math.floor(Math.random() * arr.length)];
            
            // --- Generate Student Info ---
            const lastName = getRandomItem(vietnameseLastNames);
            const middleAndFirstName = getRandomItem(vietnameseMiddleAndFirstNames);
            const fullName = `${lastName} ${middleAndFirstName}`;
            const givenName = middleAndFirstName.split(' ').pop();
            const randomThreeDigits = Math.floor(100 + Math.random() * 900);
            const email = `${removeDiacritics(givenName).toLowerCase()}.${removeDiacritics(lastName).toLowerCase()}.${randomThreeDigits}@hcmcc.edu.vn`;

            document.getElementById('fullName').innerText = fullName;
            document.getElementById('studentEmail').innerText = email;
            document.getElementById('studentId').innerText = `SV${Math.floor(10000000 + Math.random() * 90000000)}`;
            const dobDay = String(Math.floor(1 + Math.random() * 28)).padStart(2, '0');
            const dobYear = 2003 + Math.floor(Math.random() * 4);
            document.getElementById('dob').innerText = `${dobDay}/${getRandomItem(months)}/${dobYear}`;
            document.getElementById('program').innerText = getRandomItem(programs);
            const paymentDay = String(Math.floor(1 + Math.random() * 28)).padStart(2, '0');
            document.getElementById('paymentDate').innerText = `${paymentDay}/${getRandomItem(months)}/2025`;
            document.getElementById('transactionId').innerText = Math.random().toString(36).substring(2, 12).toUpperCase();

            // --- Randomize Fees ---
            const tuition = 12000000 + Math.random() * 8000000;
            const studentServices = 300000 + Math.random() * 700000;
            const healthServices = 200000 + Math.random() * 500000;
            const techFee = 250000 + Math.random() * 350000;
            const unionFee = 100000 + Math.random() * 100000;
            const scholarship = -(1000000 + Math.random() * 7000000);

            const feeElements = document.querySelectorAll('.fee-item');
            feeElements[0].innerText = formatCurrency(tuition);
            feeElements[1].innerText = formatCurrency(studentServices);
            feeElements[2].innerText = formatCurrency(healthServices);
            feeElements[3].innerText = formatCurrency(techFee);
            feeElements[4].innerText = formatCurrency(unionFee);

            document.getElementById('scholarship').innerText = formatCurrency(scholarship, true); // true for parentheses

            // --- Calculate totals based on new fees ---
            calculateTotals();

            // --- Set Amount Paid to match Total Due ---
            const totalDueValue = parseCurrency(document.getElementById('totalDue').innerText);
            document.getElementById('amountPaid').innerText = formatCurrency(totalDueValue);
            
            // --- Recalculate to set Balance to Zero ---
            calculateTotals();
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', function() {
            randomizeData();
        });
    </script>
</body>
</html>

